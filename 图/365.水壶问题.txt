//æœ‰ä¸¤ä¸ªæ°´å£¶ï¼Œå®¹é‡åˆ†åˆ«ä¸º jug1Capacity å’Œ jug2Capacity å‡ã€‚æ°´çš„ä¾›åº”æ˜¯æ— é™çš„ã€‚ç¡®å®šæ˜¯å¦æœ‰å¯èƒ½ä½¿ç”¨è¿™ä¸¤ä¸ªå£¶å‡†ç¡®å¾—åˆ° targetCap
//acity å‡ã€‚ 
//
// å¦‚æœå¯ä»¥å¾—åˆ° targetCapacity å‡æ°´ï¼Œæœ€åè¯·ç”¨ä»¥ä¸Šæ°´å£¶ä¸­çš„ä¸€æˆ–ä¸¤ä¸ªæ¥ç››æ”¾å–å¾—çš„ targetCapacity å‡æ°´ã€‚ 
//
// ä½ å¯ä»¥ï¼š 
//
// 
// è£…æ»¡ä»»æ„ä¸€ä¸ªæ°´å£¶ 
// æ¸…ç©ºä»»æ„ä¸€ä¸ªæ°´å£¶ 
// ä»ä¸€ä¸ªæ°´å£¶å‘å¦å¤–ä¸€ä¸ªæ°´å£¶å€’æ°´ï¼Œç›´åˆ°è£…æ»¡æˆ–è€…å€’ç©º 
// 
//
// 
//
// ç¤ºä¾‹ 1: 
//
// 
//è¾“å…¥: jug1Capacity = 3, jug2Capacity = 5, targetCapacity = 4
//è¾“å‡º: true
//è§£é‡Šï¼šæ¥è‡ªè‘—åçš„Â "Die Hard" 
//
// ç¤ºä¾‹ 2: 
//
// 
//è¾“å…¥: jug1Capacity = 2, jug2Capacity = 6, targetCapacity = 5
//è¾“å‡º: false
// 
//
// ç¤ºä¾‹ 3: 
//
// 
//è¾“å…¥: jug1Capacity = 1, jug2Capacity = 2, targetCapacity = 3
//è¾“å‡º: true
// 
//
// 
//
// æç¤º: 
//
// 
// 1 <= jug1Capacity, jug2Capacity, targetCapacity <= 106 
// 
// Related Topics æ·±åº¦ä¼˜å…ˆæœç´¢ å¹¿åº¦ä¼˜å…ˆæœç´¢ æ•°å­¦ 
// ğŸ‘ 357 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
import java.util.ArrayList;
import java.util.HashSet;
import java.util.LinkedList;
import java.util.List;
import java.util.Objects;
import java.util.Queue;
import java.util.Set;

public class Solution {

    public boolean canMeasureWater(int x, int y, int z) {
        // ç‰¹åˆ¤
        if (z == 0) {
            return true;
        }
        if (x + y < z) {
            return false;
        }

        State initState = new State(0, 0);

        // å¹¿åº¦ä¼˜å…ˆéå†ä½¿ç”¨é˜Ÿåˆ—
        Queue<State> queue = new LinkedList<>();
        Set<State> visited = new HashSet<>();

        queue.offer(initState);
        visited.add(initState);

        while (!queue.isEmpty()) {
            State head = queue.poll();

            int curX = head.getX();
            int curY = head.getY();

            // curX + curY == z æ¯”è¾ƒå®¹æ˜“å¿½ç•¥
            if (curX == z || curY == z || curX + curY == z) {
                return true;
            }

            // ä»å½“å‰çŠ¶æ€è·å¾—æ‰€æœ‰å¯èƒ½çš„ä¸‹ä¸€æ­¥çš„çŠ¶æ€
            List<State> nextStates = getNextStates(curX, curY, x, y);

            // æ‰“å¼€ä»¥ä¾¿äºè§‚å¯Ÿï¼Œè°ƒè¯•ä»£ç 
            // System.out.println(head + " => " + nextStates);

            for (State nextState : nextStates) {
                if (!visited.contains(nextState)) {
                    queue.offer(nextState);
                    // æ·»åŠ åˆ°é˜Ÿåˆ—ä»¥åï¼Œå¿…é¡»é©¬ä¸Šè®¾ç½®ä¸ºå·²ç»è®¿é—®ï¼Œå¦åˆ™ä¼šå‡ºç°æ­»å¾ªç¯
                    visited.add(nextState);
                }
            }
        }
        return false;
    }

    private List<State> getNextStates(int curX, int curY, int x, int y) {
        // æœ€å¤š 8 ä¸ªå¯¹è±¡ï¼Œé˜²æ­¢åŠ¨æ€æ•°ç»„æ‰©å®¹ï¼Œä¸è¿‡ Java é»˜è®¤çš„åˆå§‹åŒ–å®¹é‡è‚¯å®šå¤§äº 8 ä¸ª
        List<State> nextStates = new ArrayList<>(8);

        // æŒ‰ç†è¯´åº”è¯¥å…ˆåˆ¤æ–­çŠ¶æ€æ˜¯å¦å­˜åœ¨ï¼Œå†ç”Ÿæˆã€ŒçŠ¶æ€ã€å¯¹è±¡ï¼Œè¿™é‡Œä¸ºäº†é˜…è¯»æ–¹ä¾¿ï¼Œä¸€æ¬¡ç”Ÿæˆ 8 ä¸ªå¯¹è±¡

        // ä»¥ä¸‹ä¸¤ä¸ªçŠ¶æ€ï¼Œå¯¹åº”æ“ä½œ 1
        // å¤–éƒ¨åŠ æ°´ï¼Œä½¿å¾— A æ»¡
        State nextState1 = new State(x, curY);
        // å¤–éƒ¨åŠ æ°´ï¼Œä½¿å¾— B æ»¡
        State nextState2 = new State(curX, y);

        // ä»¥ä¸‹ä¸¤ä¸ªçŠ¶æ€ï¼Œå¯¹åº”æ“ä½œ 2
        // æŠŠ A æ¸…ç©º
        State nextState3 = new State(0, curY);
        // æŠŠ B æ¸…ç©º
        State nextState4 = new State(curX, 0);

        // ä»¥ä¸‹å››ä¸ªçŠ¶æ€ï¼Œå¯¹åº”æ“ä½œ 3
        // ä» A åˆ° Bï¼Œä½¿å¾— B æ»¡ï¼ŒA è¿˜æœ‰å‰©
        State nextState5 = new State(curX - (y - curY), y);
        // ä» A åˆ° Bï¼Œæ­¤æ—¶ A çš„æ°´å¤ªå°‘ï¼ŒA å€’å°½ï¼ŒB æ²¡æœ‰æ»¡
        State nextState6 = new State(0, curX + curY);

        // ä» B åˆ° Aï¼Œä½¿å¾— A æ»¡ï¼ŒB è¿˜æœ‰å‰©ä½™
        State nextState7 = new State(x, curY - (x - curX));
        // ä» B åˆ° Aï¼Œæ­¤æ—¶ B çš„æ°´å¤ªå°‘ï¼ŒB å€’å°½ï¼ŒA æ²¡æœ‰æ»¡
        State nextState8 = new State(curX + curY, 0);

        // æ²¡æœ‰æ»¡çš„æ—¶å€™ï¼Œæ‰éœ€è¦åŠ æ°´
        if (curX < x) {
            nextStates.add(nextState1);
        }
        if (curY < y) {
            nextStates.add(nextState2);
        }

        // æœ‰æ°´çš„æ—¶å€™ï¼Œæ‰éœ€è¦å€’æ‰
        if (curX > 0) {
            nextStates.add(nextState3);
        }
        if (curY > 0) {
            nextStates.add(nextState4);
        }

        // æœ‰å‰©ä½™æ‰å€’
        if (curX - (y - curY) > 0) {
            nextStates.add(nextState5);
        }
        if (curY - (x - curX) > 0) {
            nextStates.add(nextState7);
        }

        // å€’è¿‡å»å€’ä¸æ»¡æ‰å€’
        if (curX + curY < y) {
            nextStates.add(nextState6);
        }
        if (curX + curY < x) {
            nextStates.add(nextState8);
        }
        return nextStates;
    }

    private class State {
        private int x;
        private int y;

        public State(int x, int y) {
            this.x = x;
            this.y = y;
        }

        public int getX() {
            return x;
        }

        public int getY() {
            return y;
        }

        @Override
        public String toString() {
            return "State{" +
                    "x=" + x +
                    ", y=" + y +
                    '}';
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) {
                return true;
            }
            if (o == null || getClass() != o.getClass()) {
                return false;
            }
            State state = (State) o;
            return x == state.x &&
                    y == state.y;
        }

        @Override
        public int hashCode() {
            return Objects.hash(x, y);
        }
    }
}
//leetcode submit region end(Prohibit modification and deletion)
