//ç»™å®šä¸€ä¸ªåˆ—è¡¨ accountsï¼Œæ¯ä¸ªå…ƒç´  accounts[i] æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´  accounts[i][0] æ˜¯ åç§° (name)ï¼Œå…¶
//ä½™å…ƒç´ æ˜¯ emails è¡¨ç¤ºè¯¥è´¦æˆ·çš„é‚®ç®±åœ°å€ã€‚ 
//
// ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³åˆå¹¶è¿™äº›è´¦æˆ·ã€‚å¦‚æœä¸¤ä¸ªè´¦æˆ·éƒ½æœ‰ä¸€äº›å…±åŒçš„é‚®ç®±åœ°å€ï¼Œåˆ™ä¸¤ä¸ªè´¦æˆ·å¿…å®šå±äºåŒä¸€ä¸ªäººã€‚è¯·æ³¨æ„ï¼Œå³ä½¿ä¸¤ä¸ªè´¦æˆ·å…·æœ‰ç›¸åŒçš„åç§°ï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½å±äºä¸åŒçš„äººï¼Œå› ä¸º
//äººä»¬å¯èƒ½å…·æœ‰ç›¸åŒçš„åç§°ã€‚ä¸€ä¸ªäººæœ€åˆå¯ä»¥æ‹¥æœ‰ä»»æ„æ•°é‡çš„è´¦æˆ·ï¼Œä½†å…¶æ‰€æœ‰è´¦æˆ·éƒ½å…·æœ‰ç›¸åŒçš„åç§°ã€‚ 
//
// åˆå¹¶è´¦æˆ·åï¼ŒæŒ‰ä»¥ä¸‹æ ¼å¼è¿”å›è´¦æˆ·ï¼šæ¯ä¸ªè´¦æˆ·çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åç§°ï¼Œå…¶ä½™å…ƒç´ æ˜¯ æŒ‰å­—ç¬¦ ASCII é¡ºåºæ’åˆ— çš„é‚®ç®±åœ°å€ã€‚è´¦æˆ·æœ¬èº«å¯ä»¥ä»¥ ä»»æ„é¡ºåº è¿”å›ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼šaccounts = [["John", "johnsmith@mail.com", "john00@mail.com"], ["John", 
//"johnnybravo@mail.com"], ["John", "johnsmith@mail.com", "john_newyork@mail.com"], [
//"Mary", "mary@mail.com"]]
//è¾“å‡ºï¼š[["John", 'john00@mail.com', 'john_newyork@mail.com', 'johnsmith@mail.com']
//,  ["John", "johnnybravo@mail.com"], ["Mary", "mary@mail.com"]]
//è§£é‡Šï¼š
//ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ª John æ˜¯åŒä¸€ä¸ªäººï¼Œå› ä¸ºä»–ä»¬æœ‰å…±åŒçš„é‚®ç®±åœ°å€ "johnsmith@mail.com"ã€‚ 
//ç¬¬äºŒä¸ª John å’Œ Mary æ˜¯ä¸åŒçš„äººï¼Œå› ä¸ºä»–ä»¬çš„é‚®ç®±åœ°å€æ²¡æœ‰è¢«å…¶ä»–å¸æˆ·ä½¿ç”¨ã€‚
//å¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›è¿™äº›åˆ—è¡¨ï¼Œä¾‹å¦‚ç­”æ¡ˆ [['Mary'ï¼Œ'mary@mail.com']ï¼Œ['John'ï¼Œ'johnnybravo@mail.com']ï¼Œ
//['John'ï¼Œ'john00@mail.com'ï¼Œ'john_newyork@mail.com'ï¼Œ'johnsmith@mail.com']] ä¹Ÿæ˜¯æ­£ç¡®çš„
//ã€‚
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼šaccounts = [["Gabe","Gabe0@m.co","Gabe3@m.co","Gabe1@m.co"],["Kevin",
//"Kevin3@m.co","Kevin5@m.co","Kevin0@m.co"],["Ethan","Ethan5@m.co","Ethan4@m.co",
//"Ethan0@m.co"],["Hanzo","Hanzo3@m.co","Hanzo1@m.co","Hanzo0@m.co"],["Fern","Fern5@m.
//co","Fern1@m.co","Fern0@m.co"]]
//è¾“å‡ºï¼š[["Ethan","Ethan0@m.co","Ethan4@m.co","Ethan5@m.co"],["Gabe","Gabe0@m.co",
//"Gabe1@m.co","Gabe3@m.co"],["Hanzo","Hanzo0@m.co","Hanzo1@m.co","Hanzo3@m.co"],[
//"Kevin","Kevin0@m.co","Kevin3@m.co","Kevin5@m.co"],["Fern","Fern0@m.co","Fern1@m.
//co","Fern5@m.co"]]
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// 1 <= accounts.length <= 1000 
// 2 <= accounts[i].length <= 10 
// 1 <= accounts[i][j].length <= 30 
// accounts[i][0] ç”±è‹±æ–‡å­—æ¯ç»„æˆ 
// accounts[i][j] (for j > 0) æ˜¯æœ‰æ•ˆçš„é‚®ç®±åœ°å€ 
// 
// Related Topics æ·±åº¦ä¼˜å…ˆæœç´¢ å¹¿åº¦ä¼˜å…ˆæœç´¢ å¹¶æŸ¥é›† æ•°ç»„ å­—ç¬¦ä¸² ğŸ‘ 343 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
class Solution {
    public List<List<String>> accountsMerge(List<List<String>> accounts) {
        // ä½œç”¨ï¼šå­˜å‚¨æ¯ä¸ªé‚®ç®±å±äºå“ªä¸ªè´¦æˆ· ï¼ŒåŒæ—¶ åœ¨éå†é‚®ç®±æ—¶ï¼Œåˆ¤æ–­é‚®ç®±æ˜¯å¦å‡ºç°è¿‡[å»é‡]
        // æ ¼å¼ï¼š<é‚®ç®±ï¼Œè´¦æˆ·id>
        Map<String, Integer> emailToId = new HashMap<>();
        int n = accounts.size();//idä¸ªæ•°
        UnionFind myUnion = new UnionFind(n);
        for(int i = 0; i < n; i++){
            int num = accounts.get(i).size();
            for(int j = 1; j < num; j++){
                String curEmail = accounts.get(i).get(j);
                //å½“å‰é‚®ç®±æ²¡æœ‰å‡ºç°è¿‡
                if(!emailToId.containsKey(curEmail)){
                    emailToId.put(curEmail, i);
                }else{//å½“å‰é‚®ç®±å·²ç»å‡ºç°è¿‡ï¼Œé‚£ä¹ˆä»£è¡¨è¿™ä¸¤ä¸ªç”¨æˆ·æ˜¯åŒä¸€ä¸ª
                    myUnion.union(i, emailToId.get(curEmail));
                }
            }
        }
        //è¿›è¡Œå®Œä¸Šé¢çš„æ­¥éª¤ï¼ŒåŒä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰é‚®ç®±å·²ç»å±äºåŒä¸€ä¸ªè¿é€šåŸŸäº†ï¼Œä½†æ˜¯å°±ç®—åœ¨åŒä¸€ä¸ªè¿é€šåŸŸï¼Œä¸åŒçš„é‚®ç®±è¿˜æ˜¯å¯èƒ½ä¼šå¯¹åº”ä¸åŒçš„id
        // ä½œç”¨ï¼š å­˜å‚¨æ¯ä¸ªè´¦æˆ·ä¸‹çš„é‚®ç®±
        // æ ¼å¼ï¼š <è´¦æˆ·id, é‚®ç®±åˆ—è¡¨> >
        // æ³¨æ„ï¼šè¿™é‡Œçš„keyå¿…é¡»æ˜¯è´¦æˆ·idï¼Œä¸èƒ½æ˜¯è´¦æˆ·åç§°ï¼Œåç§°å¯èƒ½ç›¸åŒï¼Œä¼šé€ æˆè¦†ç›–
        Map<Integer, List<String>> idToEmails = new HashMap<>();
        //å°†åŒä¸€ä¸ªè¿é€šåŸŸå†…çš„é‚®ç®±å¯¹åº”åˆ°åŒä¸€ä¸ªidã€ä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°çš„idï¼Œæ¯”å¦‚4ã€5åœ¨åŒä¸€ä¸ªè¿é€šåŸŸï¼Œé‚£ä¹ˆè¿™ä¸ªè¿é€šåŸŸå¯¹åº”çš„idå°±æ˜¯4ã€‘
        for(Map.Entry<String, Integer> entry : emailToId.entrySet()){
            int id = myUnion.find(entry.getValue());
            List<String> emails = idToEmails.getOrDefault(id, new ArrayList<>());
            emails.add(entry.getKey());
            idToEmails.put(id,emails);
        }
        //ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œå·²ç»åšåˆ°äº†idå’Œé‚®ç®±é›†åˆå¯¹åº”èµ·æ¥ï¼Œæ¥ä¸‹æ¥æŠŠç”¨æˆ·åå¯¹åº”èµ·æ¥å°±å¯ä»¥äº†
        List<List<String>> res = new ArrayList<>();
        for(Map.Entry<Integer, List<String>> entry : idToEmails.entrySet()){
            List<String> emails = entry.getValue();
            Collections.sort(emails);
            List<String> tmp = new ArrayList<>();
            tmp.add(accounts.get(entry.getKey()).get(0));//å…ˆæ·»åŠ ç”¨æˆ·å
            tmp.addAll(emails);
            res.add(tmp);
        }
        return res;
    }
}

class UnionFind {
    int[] parent;

    public UnionFind(int n) {
        parent = new int[n];
        for (int i = 0; i < n; i++) {
            parent[i] = i;
        }
    }

    public void union(int index1, int index2) {
        parent[find(index2)] = find(index1);
    }

    public int find(int index) {
        if (parent[index] != index) {
            parent[index] = find(parent[index]);
        }
        return parent[index];
    }
}
//leetcode submit region end(Prohibit modification and deletion)
